<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3th proxies test</title>

  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" type="text/css" />
  <script src="https://cdn.tailwindcss.com"></script>

  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js" integrity="sha384-2huaZvOR9iDzHqslqwpR87isEmrfxqyWOF7hr7BY6KG0+hVKLoEXMPUJw3ynWuhO" crossorigin="anonymous"></script>

  <script type="module">
    import { Chat, User, Myself, Message, MyMessage } from './chat.js';

    document.addEventListener("DOMContentLoaded", async () => {
      /* const user = new User({ username: "Garito" });
      user.render(".users");
      const myself = new Myself({ username: "Fractal" });
      myself.render(".users")
      const message = new Message({
        id: "0dc38eed", username: "Garito", timestamp: Date.now(), message: "This is the test message"
      });
      message.render(".messages");
      const mymessage = new MyMessage({
        id: "b1e6eff8", username: "Fractal", timestamp: Date.now(), message: "This is my test message"
      });
      mymessage.render(".messages"); */

      /* const chatData = {
        users: [ { username: "Garito" }, { username: "Fractal" } ],
        msgs: [
          {
            id: "0dc38eed", username: "Garito", timestamp: Date.now(), msg: "This is the test message"
          },
          {
            id: "b1e6eff8", username: "Fractal", timestamp: Date.now(), msg: "This is my test message"
          }
        ]
      } */
      const chatData = {};
      const token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJGcmFjdGFsIiwiZXhwIjoxNzI2MDkzOTgzfQ.SlWIoLnLzGQsRCr3QtTR3e9Q5BLqMCv9DohcT2fLcEs";
      const chat = new Chat(chatData, "ws://localhost:3000", "Fractal", token, "gazeta", "admin");
      chat.render("body");
    });
  </script>
</head>
<body>
  <template id="User">
    <div class="avatar placeholder">
      <div class="bg-neutral text-neutral-content w-8 rounded-full">
        <span data-prop="username"></span>
      </div>
    </div>
  </template>

  <template id="Message">
    <div data-class="Message" class="chat chat-start">
      <div class="chat-header"><span data-prop="username"></span></div>
      <div class="chat-bubble" data-prop="msg"></div>
      <div class="chat-footer opacity-75">
        <time class="text-xs" data-prop="timestamp" data-type="Date"></time>
      </div>
    </div>
  </template>

  <template id="Chat">
    <div data-class="Chat" class="w-3/12 h-[calc(100vh-5rem)] flex flex-col gap-2">
      <div class="flex flex-1 w-full">
        <div data-prop="msgs" data-type="Array" class="flex flex-col-reverse flex-0 px-2 w-full h-full overflow-y-auto"></div>
        <div data-prop="users" data-type="Array" class="flex flex-col gap-2 flex-1 px-2 w-full h-full"></div>
      </div>
      <form class="join">
        <input name="msg" class="input input-bordered join-item w-full" placeholder="Type your message" disabled />
        <button type="submit" class="btn join-item" disabled>Send</button>
      </form>
    </div>
  </template>

  <div class="users"></div>
  <div class="messages"></div>
</body>
</html>